<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Camera Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="css/camera.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.2/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
  </head>
  <body>
    <section class="vh-100">
        <div class="container py-5 h-100">
          <div class="row content">
            <div class="mainTop">
              <section class="section">
                <div class="container">
                  <div class="columns">
                    <div class="column is-four-fifths">
                      <video autoplay id="video"></video>
                      
                      <!-- <button class="button is-success" id="btnScreenshot">
                        <span class="icon is-small">
                          <i class="fas fa-camera"></i>
                        </span>
                      </button> -->
                      
                    </div>
                    <div class="column">
                      <h2 class="title" style="color: white;">Screenshots</h2>
                      <div id="screenshots"></div>
                    </div>
                  </div>
                </div>
              </section>
              <canvas class="is-hidden" id="canvas"></canvas>
              <div class=""> 
                <!-- <video id="video" style="width:80%; margin:auto; border:1px solid #d3d3d3; border-radius:25px; margin-top:25px" autoplay ></video>
                <canvas id="screenshots" width="640px" height="380px" style="width:80%; margin:auto; border:1px solid #d3d3d3; border-radius:25px; margin-top:25px"> </canvas>  -->
                
                <!-- <div class='snap' id="snap"> 
                  <div>
                  <img src="assets/photo-camera-interface-symbol-for-button.png" alt="Avatar" class="image">
                  </div>
                </div> -->             
                <div id="btnScreenshot" style="padding: 10px;"><button type="button" class="btn btn-primary btn-lg" style="width: 270px"> Capture</button></div>
                  <div class="d-flex justify-content-center flex-wrap">
                
                    <div class="d-flex" style="margin-bottom: 50px">
                      <div class="p-2" style="padding: 10px;"><a class="btn btn-primary" style="background-color:#2A8335" href="#" role="button">Check-In</a></div>
                      <div class="p-2" style="padding: 10px;"><a class="btn btn-primary" style="background-color:#C62020" href="#" role="button">Check-Out</a></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>    
        </div>
    </section>

    <script>
      (function () {
        if (
          !"mediaDevices" in navigator ||
          !"getUserMedia" in navigator.mediaDevices
        ) {
          alert("Camera API is not available in your browser");
          return;
        }
      
        // get page elements
        const video = document.querySelector("#video");   
        const btnScreenshot = document.querySelector("#btnScreenshot");
        const screenshotsContainer = document.querySelector("#screenshots");
        const canvas = document.querySelector("#canvas");
        const devicesSelect = document.querySelector("#devicesSelect");
      
        // video constraints
        const constraints = {
          video: {
            width: {
              min: 1280,
              ideal: 1920,
              max: 2560,
            },
            height: {
              min: 720,
              ideal: 1080,
              max: 1440,
            },
          },
        };
      
        // use front face camera
        let useFrontCamera = true;
      
        // current video stream
        let videoStream;
      
        // take screenshot
        btnScreenshot.addEventListener("click", function () {
          const img = document.createElement("img");
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          canvas.getContext("2d").drawImage(video, 0, 0);
          img.src = canvas.toDataURL("image/png");
          screenshotsContainer.prepend(img);
        });
      
        // stop video stream
        function stopVideoStream() {
          if (videoStream) {
            videoStream.getTracks().forEach((track) => {
              track.stop();
            });
          }
        }
      
        // initialize
        async function initializeCamera() {
          stopVideoStream();
          constraints.video.facingMode = useFrontCamera ? "user" : "environment";
      
          try {
            videoStream = await navigator.mediaDevices.getUserMedia(constraints);
            video.srcObject = videoStream;
          } catch (err) {
            alert("Could not access the camera");
          }
        }
      
        initializeCamera();
      })();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-kjU+l4N0Yf4ZOJErLsIcvOU2qSb74wXpOhqTvwVx3OElZRweTnQ6d31fXEoRD1Jy" crossorigin="anonymous"></script>
    <!-- <script src="script.js"></script> -->
  </body>
</html>